# MuFo - Music Folder Validator

**MuFo** is a PowerShell module for validating and organizing music libraries using Spotify API. It validates folder structures (Artist/Album/Track), corrects naming inconsistencies, and enhances audio file tags with comprehensive support for diverse music collections.

[![PowerShell 7.3+](https://img.shields.io/badge/PowerShell-7.3%2B-blue)](https://github.com/PowerShell/PowerShell)\n[![Spotify API](https://img.shields.io/badge/Spotify-API-green)](https://developer.spotify.com/)\n[![TagLib-Sharp](https://img.shields.io/badge/TagLib--Sharp-Audio%20Tags-orange)](https://github.com/mono/taglib-sharp)\n\n## ‚ú® Key Features\n\n- **üéµ Comprehensive Validation** - Artist, album, and track-level validation against Spotify data\n- **‚ö° High Performance** - Optimized search algorithms with 10-100x performance improvement\n- **üé≠ Classical Music Support** - Advanced handling for composer, conductor, and performer metadata\n- **üîß Smart Tag Enhancement** - Automatic tag filling and correction using TagLib-Sharp\n- **üìÅ Flexible Structure** - Supports various folder organization patterns\n- **üö´ Powerful Exclusions** - Wildcard pattern support for excluding unwanted content\n- **üìä Results Management** - Logging, filtering, and analysis of validation results\n- **üéõÔ∏è Multiple Modes** - Automatic, Manual, and Smart execution modes\n\n## üöÄ Quick Start\n\n### Prerequisites\n\n1. **PowerShell 7.3+** on Windows, Mac, or Linux\n2. **Spotishell module** for Spotify API access\n3. **TagLib-Sharp** for audio file tag processing (optional, auto-installed)\n\n### Installation\n\n```powershell\n# Install required Spotify API module\nInstall-Module Spotishell -Scope CurrentUser\n\n# Clone or download MuFo\ngit clone https://github.com/jmwatte/MuFo.git\ncd MuFo\n\n# Import the module\nImport-Module .\\MuFo.psm1\n\n# Install TagLib-Sharp for track tagging (optional)\nInstall-TagLibSharp\n```\n\n### Basic Usage\n\n```powershell\n# Validate current directory with Smart mode\nInvoke-MuFo -DoIt Smart\n\n# Analyze specific artist folder without changes\nInvoke-MuFo -Path \"C:\\Music\\Pink Floyd\" -WhatIf\n\n# Full library scan with logging\nInvoke-MuFo -Path \"C:\\Music\" -LogTo \"results.json\" -IncludeTracks\n```\n\n## üìñ Common Use Cases\n\n### üîç **Library Analysis**\n```powershell\n# Scan entire library, excluding live albums and demos\nInvoke-MuFo -Path \"C:\\Music\" -ExcludeFolders \"*_Live\", \"Demo*\" -Preview\n\n# Analyze with detailed output for troubleshooting\nInvoke-MuFo -Path \"C:\\Music\\Problem Artist\" -ShowEverything -Verbose\n```\n\n### üè∑Ô∏è **Tag Enhancement**\n```powershell\n# Fix missing track titles and numbers\nInvoke-MuFo -Path \"C:\\Music\" -FixTags -FixOnly \"Titles\", \"TrackNumbers\" -WhatIf\n\n# Optimize tags for classical music\nInvoke-MuFo -Path \"C:\\Music\\Classical\" -IncludeTracks -FixTags -OptimizeClassicalTags\n```\n\n### üì¶ **Box Sets and Compilations**\n```powershell\n# Validate box sets with multi-disc support\nInvoke-MuFo -Path \"C:\\Music\\BoxSets\" -BoxMode -IncludeCompilations\n\n# Check for missing tracks in albums\nInvoke-MuFo -Path \"C:\\Music\" -IncludeTracks -ValidateCompleteness\n```\n\n### üìä **Results Management**\n```powershell\n# Save results for later review\nInvoke-MuFo -Path \"C:\\Music\" -LogTo \"scan-results.json\" -DoIt Smart\n\n# Review only albums that would be renamed\nInvoke-MuFo -ShowResults -LogTo \"scan-results.json\" -Action \"rename\"\n\n# Filter high-confidence matches\nInvoke-MuFo -ShowResults -LogTo \"scan-results.json\" -MinScore 0.8\n```\n\n## üéõÔ∏è Execution Modes\n\n| Mode | Description | Best For |\n|------|-------------|----------|\n| **Manual** | Prompt for each change | Careful review, learning |\n| **Smart** | Auto-apply high confidence, prompt for uncertain | Balanced automation |\n| **Automatic** | Apply all changes without prompting | Trusted libraries, batch processing |\n\n## üìÅ Folder Structure Support\n\nMuFo adapts to various music library organizations:\n\n```\n# Standard: Artist/Album/Tracks\nC:\\Music\\Pink Floyd\\The Wall\\01 - Another Brick in the Wall.mp3\n\n# Collection: Music/Artist/Album/Tracks  \nC:\\Music\\Artists\\Pink Floyd\\The Wall\\01 - Another Brick in the Wall.mp3\n\n# Genre-based: Music/Genre/Artist/Album/Tracks\nC:\\Music\\Rock\\Pink Floyd\\The Wall\\01 - Another Brick in the Wall.mp3\n```\n\nUse `-ArtistAt` parameter to specify structure:\n- `Here`: Current path contains artist folders\n- `1D`/`2D`: Artists are 1-2 levels down\n- `1U`/`2U`: Go up 1-2 levels to find artists\n\n## üö´ Exclusion Patterns\n\nPowerful wildcard support for excluding unwanted content:\n\n```powershell\n# Exclude specific folders\n-ExcludeFolders \"Bonus\", \"Live\", \"Demos\"\n\n# Wildcard patterns\n-ExcludeFolders \"*_Live\", \"E_*\", \"Demo*\", \"Track?\"\n\n# Character classes\n-ExcludeFolders \"Demo[0-9]\", \"Track[A-Z]\"\n\n# Save and load exclusion lists\n-ExcludedFoldersSave \"my-exclusions.json\"\n-ExcludedFoldersLoad \"my-exclusions.json\"\n```\n\n## üéµ Track-Level Features\n\nWhen using `-IncludeTracks`:\n\n- **Tag Validation** - Compare local tags against Spotify data\n- **Missing Content Detection** - Identify missing titles, track numbers\n- **Completeness Checking** - Find missing tracks in albums\n- **Format Support** - .mp3, .flac, .m4a, .ogg, .wav\n- **Classical Music Analysis** - Composer and conductor detection\n\n## ‚öôÔ∏è Configuration\n\n### Confidence Threshold\n```powershell\n# Strict matching (90% similarity required)\n-ConfidenceThreshold 0.9\n\n# Permissive matching (60% similarity)\n-ConfidenceThreshold 0.6\n```\n\n### Performance Tuning\n```powershell\n# Include various release types for comprehensive matching\n-IncludeSingles -IncludeCompilations\n\n# Large library optimization\n-Preview -LogTo \"results.json\"  # Analyze first, then apply\n```\n\n## üîß Advanced Features\n\n### Spotify API Integration\n- Optimized search with multiple query strategies\n- Rate limiting and error handling\n- Confidence scoring for match quality\n- Support for various artist and album naming conventions\n\n### Audio Tag Processing\n- TagLib-Sharp integration for robust tag reading/writing\n- Support for complex metadata (composer, conductor, performer)\n- Safe tag enhancement with preview capabilities\n- Format-specific optimization\n\n### Classical Music Specialization\n- Composer-based organization suggestions\n- Conductor and performer recognition\n- Multi-movement work handling\n- Period and style classification\n\n## üìö Documentation\n\n- **[Parameter Reference](documentation/PARAMETER-REFERENCE.md)** - Complete parameter documentation\n- **[Performance Guide](documentation/PERFORMANCE-GUIDE.md)** - Optimization techniques\n- **[Track Tagging Guide](documentation/TRACK-TAGGING-DOCS.md)** - Audio tag enhancement\n- **[Current Roadmap](documentation/CURRENT-ROADMAP.md)** - Development status\n\n### Built-in Help\n```powershell\n# Comprehensive help with examples\nGet-Help Invoke-MuFo -Full\n\n# Parameter-specific help\nGet-Help Invoke-MuFo -Parameter DoIt\n\n# Examples only\nGet-Help Invoke-MuFo -Examples\n```\n\n## üõ†Ô∏è Troubleshooting\n\n### Common Issues\n\n**No Spotify Results**\n```powershell\n# Check Spotify authentication\nConnect-Spotify\n\n# Try broader matching\n-ConfidenceThreshold 0.5 -IncludeSingles -IncludeCompilations\n```\n\n**TagLib-Sharp Errors**\n```powershell\n# Reinstall TagLib-Sharp\nInstall-TagLibSharp -Force\n\n# Skip tag processing temporarily\n# (Remove -IncludeTracks -FixTags parameters)\n```\n\n**Performance Issues**\n```powershell\n# Use Preview mode for large libraries\n-Preview -LogTo \"results.json\"\n\n# Exclude problematic folders\n-ExcludeFolders \"LargeCollection\", \"*_Archive\"\n```\n\n### Debug Information\n```powershell\n# Verbose output for troubleshooting\n-Verbose -Debug\n\n# Detailed analysis results\n-ShowEverything\n\n# Error-only results review\n-ShowResults -Action \"error\"\n```\n\n## üèÜ Project Status\n\n**Current Version**: 0.1.0 (Production-Ready Core)  \n**Status**: Feature-complete for music library validation  \n**Performance**: 100% album matching success rate on real-world libraries  \n**Optimization**: 10-100x performance improvement over initial implementation  \n\n## ü§ù Contributing\n\nContributions are welcome! Please see our [Current Roadmap](documentation/CURRENT-ROADMAP.md) for development priorities.\n\n### Development Setup\n```powershell\n# Clone repository\ngit clone https://github.com/jmwatte/MuFo.git\ncd MuFo\n\n# Load module for testing\nImport-Module .\\MuFo.psm1 -Force\n\n# Run tests\n.\\tests\\test-functions-simple.ps1\n.\\tests\\test-integration.ps1\n```\n\n## üìÑ License\n\nThis project is licensed under the MIT License - see the LICENSE file for details.\n\n## üôè Acknowledgments\n\n- **Spotify Web API** for comprehensive music metadata\n- **TagLib-Sharp** for robust audio file tag processing\n- **Spotishell** PowerShell module for Spotify integration\n- PowerShell community for excellent tooling and libraries\n\n---\n\n**MuFo** - Making music library management simple, accurate, and automated. üéµ